spring:
  # --- 数据库连接 (PostgreSQL) ---
  datasource:
    driver-class-name: org.postgresql.Driver
    # 引用环境变量 DB_URL
    url: ${DB_URL:jdbc:postgresql://localhost:5432/rednote-mongodb?currentSchema=public}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}
  mail:
    host: ${MAIL_HOST}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    default-encoding: UTF-8
    protocol: smtp
    properties:
      mail:
        debug: true      # 【关键】开启调试模式，看具体交互
        smtp:
          auth: true
          ssl:
            enable: true # 强制 SSL
            trust: "*"   # 信任所有证书（解决本地证书链问题）
          socketFactory: # 某些旧版 JDK 或环境需要显式指定 socketFactory
            port: 465
            class: javax.net.ssl.SSLSocketFactory
  # --- NoSQL & Cache ---
  data:
    mongodb:
      uri: ${MONGO_URI:mongodb://localhost:27017/rednote}
      auto-index-creation: true
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      database: 0
      password: ${REDIS_PASSWORD:} # 默认为空

  elasticsearch:
    # Docker 映射到了宿主机的 9200 端口，所以用 localhost
    uris: http://localhost:9200
    socket-timeout: 30s
    connection-timeout: 5s
    # 开发环境我们关了 xpack，所以不需要 username/password
# --- 阿里云 OSS ---
aliyun:
  oss:
    enable: true # 设置为 false 启用本地 Mock 模式
    endpoint: ${ALIYUN_OSS_ENDPOINT:oss-cn-shenzhen.aliyuncs.com}
    access-key-id: ${ALIYUN_ACCESS_KEY_ID}
    access-key-secret: ${ALIYUN_ACCESS_KEY_SECRET}
    bucket-name: ${ALIYUN_BUCKET_NAME}
file:
  upload:
    path: ./uploads/ # 文件存放在项目根目录的 uploads 文件夹
    base-url: http://localhost:8080/uploads/ # 返回给前端的 URL 前缀
# --- 微信小程序配置 ---
wechat:
  appid: ${WECHAT_APPID}
  secret: ${WECHAT_SECRET}

# --- MyBatis Plus  ---
mybatis-plus:
  mapper-locations: classpath:/mapper/*.xml
  type-aliases-package: com.szu.afternoon3.platform.entity
  configuration:
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl
    map-underscore-to-camel-case: true
  global-config:
    db-config:
      logic-delete-value: 1
      logic-not-delete-value: 0

logging:
  level:
    root: INFO
    # 1. Listener: 保持 DEBUG，配合你刚才代码里的 log.debug，
    # 这样你能看到业务流转（如：收到点赞、发帖），但因为你代码里已经过滤了高频废话，所以不会太吵。
    com.szu.afternoon3.platform.listener: DEBUG

    # 2. MyBatis (SQL): 建议改为 INFO
    # 除非你在修 SQL 语句的 Bug，否则平时不要开 DEBUG。
    # DEBUG 级别不仅打印 SQL，还会打印查询出的每一行结果（Result Set），非常占屏幕。
    com.szu.afternoon3.platform.mapper: INFO

    # 3. MongoDB Template: 建议改为 INFO
    # DEBUG 会打印生成的 Query 对象。如果你信任 Spring Data 的查询生成，平时不需要看。
    org.springframework.data.mongodb.core.MongoTemplate: INFO

    # 4. 【罪魁祸首】MongoDB 驱动协议: 必须改为 WARN 或 ERROR
    # 这里是打印底层 TCP/IP 协议包的，开发时几乎永远不需要看这个，除非你在调试 MongoDB 驱动本身的 Bug。
    org.mongodb.driver.protocol.command: WARN


ai:
  deepseek:
    url: https://api.deepseek.com/chat/completions
    key: ${DEEPSEEK_API_KEY}
    model: deepseek-chat

  dashscope:
    api-key: ${QWENVL_API_KEY}
    model: qwen-vl-plus

  bot:
    user-id: ${CHATBOT_ID}
    user-nickname: ${CHATBOT_NICKNAME}

management:
  health:
    mail:
      enabled: false